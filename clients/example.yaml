vendor: Example
name: Example
code: EX
active: True
gitlab:
  admin_project:
    path: example/devops/example-admin
  salt_project:
    path: example/devops/example-salt
    runners:
      dev: gitlab-runner1.dev.example.com # shell executor with docker command
      prod: saltssh1.example.com # docker executor
    variables:
      # ssh-keygen -N "" -t ed25519 -f ./tmp/saltssh-root -C root@example.com
      SALTSSH_ROOT_ED25519_PRIV: |
        -----BEGIN OPENSSH PRIVATE KEY-----
        ...
        -----END OPENSSH PRIVATE KEY-----
      SALTSSH_ROOT_ED25519_PUB: ssh-ed25519 AAAAC3Nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx devops@example.com
    deploy_keys: []
configuration_management:
  type: salt-ssh
  #skip_roster: True # optional to do not manage roster file with code
  #sub_clients: ALL # optional, add all other clients as sub clients available in jinja vars for templates
  sub_clients: # optional, the same but specific clients
    - OtherClient1
    - OtherClient2
  templates:
    ufw_type: ufw # optional, override default ufw_type set by accounting.yaml
    root_email: mon@example.com
    telegram_token: 1111111111:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
    telegram_chat_id: -111111111
    alerta_url: https://alerta.example.com/api/alert
    alerta_api_key: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx # cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 40 | head -n 1
    alerta_api_key_id: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx # apt-get install uuid-runtime; uuidgen
    alerta_api_customer_id: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx # apt-get install uuid-runtime; uuidgen
    alerta_telegram_chat_id: -111111111
    default_tz: Etc_UTC
    client_domain: example.com
    heartbeat_mesh:
      sender:
        receiver: alerta1.example.com
        token: xxx
    runner_source_ip: 1.1.1.1
    files:
      - path: pillar/heartbeat_mesh/example/receiver.sls
        jinja: pillar/heartbeat_mesh/example/receiver.jinja.sls
      - path: include/otherclient1/pillar/rsnapshot_backup/otherclient1/backup.sls
        sub_client_project_file:
          sub_client: OtherClient1
          path: pillar/rsnapshot_backup/otherclient1/backup.sls
  salt-ssh:
    version: 3001
servers:
  - fqdn: server1.example.com
    location: Hetzner
    active: True
    os: focal
    roster_opts: # optional
      set_path: \$PATH:/opt/local/bin
      ssh_options: StrictHostKeyChecking=no
    tariffs:
      - activated: 1970-01-01
        added: 1970-01-01
        tariffs:
          - file: free-1.yaml
    jobs: # optional per server jobs
      some_job:
        type: salt_cmd
        cmd: state.apply some_state
        timeout: 36000
        tz: Europe/Kiev
        each:
          days: 1
        hours:
          - 1
